{"version":3,"sources":["assets/js/slot.js"],"names":["$","document","ready","wl_shared","init","projectId","API_URL_STAT","apiUrl","uLogin","customInit","hover","css","click","e","preventDefault","on","submitForm","focus","removeClass","text","email","val","emailRegExp","match","addClass","serializeForm","data","serializeArray","push","name","value","makeRandomStr","a","reduce","prev","curr","key","JSON","stringify","ajax","url","getParams","type","success","redirect","error","parse","responseText","errorCode","code","validationCode","description","message","possible","i","charAt","Math","floor","random","length","window","uloginAuthCb","token","post","done","response","trackService","track","then","res","location","href"],"mappings":"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","file":"slot.js","sourcesContent":["$(document).ready(function() {\n    wl_shared.init({\n        projectId: 1,\n        API_URL_STAT: '/api/v11/statistics/track/',\n        apiUrl: '//api.pdgamedev.com'\n    });\n\n    uLogin.customInit('uLoginButtons');\n\n    $('.social-img').hover(function () {\n        $('.social-img').css(\"opacity\", '1');\n    });\n\n    $('.social-img').click(function (e) {\n        e.preventDefault();\n    });\n\n    $('#email-form').on('submit', function(e) {\n        e.preventDefault();\n        submitForm();\n    });\n\n    $('.mail-input').focus(function () {\n        $('.mail-input').removeClass('mail-input-error');\n        $('.input-error-text').text('');\n    });\n\n    function submitForm() {\n        var email = $('.mail-input').val(); //Вытаскиваем из поля на форме\n        var emailRegExp = /[-0-9a-zA-Z.+_]+@[-0-9a-zA-Z.+_]+\\.[a-zA-Z]{2,4}/;\n        if (!email || !email.match(emailRegExp)) {\n            $('.mail-input').addClass('mail-input-error');\n            $('.input-error-text').text('Введите Вашу почту. Верный формат: example@gmail.com');\n            return false;\n        }\n\n        function serializeForm() {\n            var data = $('#email-form').serializeArray();\n            data.push({\n                name: \"username\",\n                value: makeRandomStr()\n            });\n            var a = data.reduce(function(prev, curr) {\n                var key = curr.name,\n                    val = curr.value;\n                prev[key] = val;\n                return prev;\n            }, {});\n            return JSON.stringify(a);\n        }\n\n        $.ajax({\n            url: \"//api.pdgamedev.com/api/v11/users?\" + wl_shared.getParams(),\n            type: \"POST\",\n            data: serializeForm(),\n            success: redirect,\n            error: function(e) {\n                var error = JSON.parse(e.responseText),\n                    errorCode;\n\n                try {\n                    errorCode = error.error.code;\n                    var validationCode = 3;\n\n                    errorCode == validationCode ? $('.input-error-text').text(error.error.description.email) : $('.input-error-text').text(error.error.message);\n                } catch (e) {}\n            }\n        });\n    }\n\n    function makeRandomStr() {\n        var text = \"\";\n        var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n        for (var i = 0; i < 10; i++)\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n        return text;\n    }\n\n    window.uloginAuthCb = function(token) {\n        $.post(\"//api.pdgamedev.com/api/v11/ulogin?\" + wl_shared.getParams(),\n            JSON.stringify({\n                token: token\n            }))\n            .done((response) => {\n                wl_shared.trackService()\n                    .track(response.data.token)\n                    .then(() => redirect(response))\n            })\n    };\n\n    function redirect(res) {\n        if (res.data.token) {\n            window.location.href = \"/sapi/loginByToken?token=\" + res.data.token + \"&landing=true\";\n        }\n    }\n});\n"]}